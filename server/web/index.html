<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Live.nvim Content Viewer</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      pre {
        background: #f0f0f0;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Live.nvim Content Viewer</h1>
    <pre id="content">Waiting for content...</pre>

    <script>
      (function () {
        var ws;

        function startWebSocket() {
          // _______
          // operation: Start WebSocket connection
          // _______

          var endpoint =
            window.location.pathname === "/"
              ? "/code"
              : window.location.pathname;
          var wsUrl = "ws://" + window.location.host + endpoint;
          ws = new WebSocket(wsUrl);

          ws.onopen = function () {
            console.log("WebSocket connection opened.");
          };

          ws.onmessage = function (event) {
            document.getElementById("content").textContent = event.data;
          };

          ws.onclose = function () {
            console.log(
              "WebSocket connection closed. Reconnecting in 3 seconds...",
            );
            setTimeout(startWebSocket, 3000);
          };

          ws.onerror = function (error) {
            console.error("WebSocket error:", error);
          };

          // end of operation: Start WebSocket connection
          // _______
        }

        startWebSocket();
      })();
    </script>
  </body>
</html>
